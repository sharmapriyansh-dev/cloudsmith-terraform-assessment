# Cloudsmith Vulnerability Policy

## Task

This page details how I used the Cloudsmith Terraform provider to create a vulnerability policy that **blocks NPM packages with Critical security vulnerabilities**.

### Terraform Example

````
provider "cloudsmith" {
  api_key = "my-api-key"
}

data "cloudsmith_organization" "my_org" {
  slug = "my-organization"
}

# Example team to attach vulnerability policy (optional)
resource "cloudsmith_team" "security_team" {
  organization = data.cloudsmith_organization.my_org.slug
  name         = "Security Team"
}
````

#### NPM Critical Block Policy

````
resource "cloudsmith_vulnerability_policy" "npm_critical_block" {
  name                    = "Block NPM: Critical"
  description             = "Block any NPM packages with a Critical security scan result"
  min_severity            = "Critical"
  on_violation_quarantine = true   # Block instead of quarantine
  allow_unknown_severity  = false  # Do not allow unknown severity packages
  package_query_string    = "format:npm"
  organization            = var.organization
}
````

#### Output

![Vulnerability Policy](tfm-state-vulnerability-npm-critical.png)
