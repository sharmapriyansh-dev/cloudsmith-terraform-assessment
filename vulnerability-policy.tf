
# Block NPM packages with Critical vulnerabilities in Production repository
resource "cloudsmith_vulnerability_policy" "npm_critical_block" {
  name                    = "Block NPM: Critical"
  description             = "Block any NPM packages with a Critical security scan result"
  min_severity            = "Critical"
  on_violation_quarantine = true  # we want to block instead of quarantine
  allow_unknown_severity  = false # do not allow unknown severity packages
  package_query_string    = "format:npm"
  organization            = var.organization
}
